---
title: "PracticalMachineLearning_ROBMILL"
output: html_document
---
### Final Peer Reviewed Assignment
## Practical Machine Learning
## Week 4

```{r preparation}
# Load Librarys
# Load Data
library(kernlab)
library(caret)
library(ggplot2)
library(Hmisc)
library(gridExtra)
library(graphics)
library(klaR)

#training<-read.csv(file = "pml-training.csv",stringsAsFactors #= FALSE) # Read training data

exerciseData<-read.csv(file = "pml-trainingMod.csv",
                   stringsAsFactors = FALSE) # Read training data

validation<-read.csv(file = "pml-testing.csv",stringsAsFactors = FALSE) # Read testing data

dim(exerciseData)
```

### Initial EDA on Raw Data Set
Data comes from: 
1.  <http://groupware.les.inf.puc-rio.br/har>
2.  <http://groupware.les.inf.puc-rio.br/har#weight_lifting_exercises>

The data set describes quality of execution for the wearer while doing dumbell lift exercises.  

Different Classes of execution quality.  High level Class A represents an example of successful execution of the exercise while Classes B-E represent examples of common mistakes made.  

* Class A: exactly according to specification.
* Class B: throwing the elbows to the front.
* Class C: lifting the dumbell only halfway.
* Class D: lowering dumbell only halfway.
* Class E: throwing the hips to the front.

### The goal of the exercise is to identify predictors that accurately determine execution quality or manner of exercise.

Similar to the iris data set exercise predicting species based on a set of features.  q
```{r EDA }

dim(exerciseData) # display number or rows/columns

head(exerciseData) # display first few rows
table(exerciseData$classe) # display a table using classe


# Density plots
qplot(total_accel_arm,colour=classe,
      data=exerciseData, geom="density")

qplot(total_accel_forearm,colour=classe,
      data=exerciseData,geom="density")

qplot(total_accel_dumbbell,colour=classe,
      data=exerciseData, geom="density")

qplot(total_accel_belt,colour=classe,
      data=exerciseData, geom="density")

featurePlot(x=exerciseData[,c("total_accel_forearm","total_accel_dumbbell","total_accel_belt","total_accel_arm")], 
            y=exerciseData$classe, 
            plot="pairs",
            auto.key=list(columns = 4))
```


### Partition exerciseData Data and Processing
```{r Data Partitioning and Preproc}

inTrain<-createDataPartition(exerciseData$classe,p=0.70,list=FALSE)


training<-exerciseData[inTrain,]
testing<-exerciseData[-inTrain,]

dim(training)
dim(testing)

```


```{r model fitting Naive Bayes}

training$classe<-as.factor(training$classe)
training$classe

modFit.NB<-NaiveBayes(classe~., data=training,na.action = na.omit)

predictions<-predict(modFit.NB,testing)
predictions$class


confusionMatrix(predictions$class,testing$classe)
```


```{r model fitting Classification Tree}
modFit.rpart<-train(classe~total_accel_dumbbell+total_accel_arm+total_accel_belt,method="rpart",data=training)

print(modFit.rpart$finalModel)

plot(modFit.rpart$finalModel,uniform=TRUE,
     main="Classification Tree")
text(modFit.rpart$finalModel,use.n=TRUE,all=TRUE,cex=0.8)

predictions.rpart<-predict(modFit.rpart,newdata=testing)
```


### Run a Boosting Algorithm against all features
* modFit.boost<-train(classe~.,method="gbm",
              data=training,
              verbose=FALSE)
```{r model fitting Boosting, include=FALSE}
modFit.boost<-train(classe~.,method="gbm",
              data=training,
              verbose=FALSE,na.action = na.pass)

predictions.boost<-predict(modFit.boost,newdata=testing)

```

```{r model printing Boosting}
print(modFit.boost)
```


## Citation
Velloso, E.; Bulling, A.; Gellersen, H.; Ugulino, W.; Fuks, H. Qualitative Activity Recognition of Weight Lifting Exercises. Proceedings of 4th International Conference in Cooperation with SIGCHI (Augmented Human '13) . Stuttgart, Germany: ACM SIGCHI, 2013.

Read more: <http://groupware.les.inf.puc-rio.br/har#weight_lifting_exercises#ixzz4aHsvXnQK>

### Useful links

[Preprocess method](https://www.rdocumentation.org/packages/caret/versions/6.0-73/topics/preProcess)

[Caret package](https://topepo.github.io/caret/model-training-and-tuning.html)